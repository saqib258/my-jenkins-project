pipeline {
    agent any // This is the required top-level agent directive

    stages { // MUST have the 'stages' block
        
        stage('Checkout Code') {
            steps { // The 'steps' block is correctly placed inside the 'stage'
                checkout scm
            }
        }

        stage('Build Docker Image') {
            // The Docker agent must be defined at the 'stage' level
            agent {
                docker {
                    image 'docker:dind' 
                    args '--privileged'
                }
            }
            // The steps block for this stage MUST come directly after the agent block
            steps { 
                sh 'docker build -t hello-jenkins .'
            }
        }
        
        // Add more stages here...
    }
}
